<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>JSON Viewer</title>
<link rel="icon" type="image/png" href="misc/icons8-feather-55.png">
<style>
  *{margin:0;padding:0;box-sizing:border-box}
  html,body{
    height:100%;width:100%;
    display:flex;align-items:center;justify-content:center;
    background:#1a1a4d;
  }
  #grid{display:grid;gap:0}
  .cell{width:100%;height:100%}
  .c-0 { background:#1a1a4d }
  .c-1 { background:#1a1a4d }
  .c-2 { background:#2a2a66 }
  .c-3 { background:#3b3b80 }
  .c-4 { background:#5555a0 }
  .c-5 { background:#7070b8 }
  .c-6 { background:#8c8cd0 }
  .c-7 { background:#a8a8e6 }
  .c-8 { background:#ccccff }
  .c-9 { background:#ccccff }
</style>
</head>
<body>

<div id="grid"></div>

<script>
const COLS = 160, ROWS = 90;
const grid = document.getElementById('grid');

function drawImage(arr){
  grid.innerHTML='';
  grid.style.gridTemplateColumns=`repeat(${COLS},1fr)`;
  grid.style.gridTemplateRows=`repeat(${ROWS},1fr)`;
  grid.style.width=`calc(min(100vw / ${COLS}, 100vh / ${ROWS}) * ${COLS})`;
  grid.style.height=`calc(min(100vw / ${COLS}, 100vh / ${ROWS}) * ${ROWS})`;
  const frag=document.createDocumentFragment();
  arr.forEach(v=>{
    const d=document.createElement('div');
    d.className='cell c-'+v;
    frag.appendChild(d);
  });
  grid.appendChild(frag);
}

function handleJSON(file){
  const reader=new FileReader();
  reader.onload=e=>{
    try{
      const j=JSON.parse(e.target.result);
      const raw=Array.from(j.data).map(c=>parseInt(c));
      if(raw.length !== COLS * ROWS){
        console.warn("Unexpected data size, expected 160x90 =", COLS*ROWS);
        return;
      }
      drawImage(raw);
    }catch(err){console.warn("Invalid JSON",err);}
  };
  reader.readAsText(file);
}

window.addEventListener('dragover',e=>e.preventDefault());
window.addEventListener('drop',e=>{
  e.preventDefault();
  if(e.dataTransfer.files.length){
    const f=e.dataTransfer.files[0];
    if(f.type==='application/json') handleJSON(f);
  }
});
</script>
</body>
</html>
